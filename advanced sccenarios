In the first year after a customer joins the gold program (including their joining date) irrespective of what the customer has purchased
they earn 5 zomato points for every 10rs spent. Who earned more 1 or 3? and what were their earnings


select c.*,d.price*0.5 as total_points from
(select s.userid,s.created_date,s.product_id,g.gold_signup_date from sales s inner join goldusers_signup g
on s.userid = g.userid and created_date >= gold_signup_date and created_date<= date_add(gold_signup_date,interval 1 YEAR))c
inner join product d on c.product_id = d.product_id

               prodid                 total_points
3	2017-12-07	2	2017-04-21	435.0
1	2018-03-19	3	2017-09-22	165.0